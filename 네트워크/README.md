# 네트워크
### 웹 브라우저
* 브라우저 : 리퀘스트 메시지를 작성하여 프로토콜 스택에 송신을 의뢰
* 웹 서버 : 리퀘스트 메시지를 수신하여 내부 로직을 실행하여 응답 메시지 작성 후 클라이언트에 반송
* URL : Uniform Resource Locator (데이터의 위치를 나타냄)
* URI : Uniform Resource Identifier (데이터를 식별함)
* 리퀘스트 메시지 : 리퀘스트 라인(메소드 + URI + HTTP 버전), 헤더, 본문으로 구성
* 응답 메시지 : 스테이터스 라인(HTTP 버전 + 스테이터스 코드 + 응답 문구), 헤더, 본문으로 구성
* IP 주소 : 서브넷을 식별하는 네트워크 번호와 서브넷 내부 네트워크 인터페이스를 식별하는 호스트 번호로 구성
    * 네트워크 번호와 호스트 번호의 경계는 넷마스크로 식별
    * 호스트 번호가 모두 0이면 서브넷 자체를, 모두 1이면 브로드캐스트를 의미
* 리졸버 : Socket 라이브러리의 부품화된 프로그램으로 도메인명을 IP 주소로 변환
    * 이때 UDP에 의뢰하여 DNS 서버에 IP 주소 조회 메시지를 보냄
    * Socket 라이브러리의 프로그램 부품들을 이용하면 OS의 네트워크 기능을 애플리케이션에서 호출 가능
* DNS 서버 : 도메인명과 IP 주소의 대응표를 조사하여 IP 주소를 회답
    * 접근 순서 : 클라이언트의 TCP/IP 설정 정보에 등록된 DNS 서버 -> 루트 도메인 DNS 서버 -> 하위 도메인 DNS 서버들 (캐시 기능을 이용하는 경우 중간 과정 건너뜀)
* 도메인명 : 도메인들이 모여 계층적 구조를 이룬 이름
* 웹 브라우저의 동작 순서
    * name resolution(리졸버 호출) -> 소켓 작성(socket 호출) -> 접속(connect 호출) -> 리퀘스트 메시지 송신(write 호출) -> 응답 메시지 수신(read 호출) -> 연결 끊기(close 호출)


### 프로토콜 스택 (TCP/IP)
* 프로토콜 스택 : OS에 내장된 네트워크 제어용 소프트웨어
* TCP : Transmission Control Protocol, 일반적인 데이터 송수신에 사용하는 연결지향 프로토콜
* UDP : User Datagram Protocol, 짧은 제어용 데이터 송수신에 사용하는 비연결 프로토콜
    * TCP가 연결지향인 것은 데이터가 유실되었을 때 효율적으로 다시 보내기 위한 것임
    * 데이터가 한 개의 패킷에 수용할 수 있을 만큼 짧은 경우 데이터가 유실되었을 때 전체 데이터를 다시 보내기만 하면 되고, 회신이 수신 확인 응답을 대신하므로 TCP의 복잡한 과정이 필요 없음
* IP : Internet Protocol, 패킷 운반, 경로 설정에 사용하는 프로토콜
* 소켓 : 프로토콜 스택의 메모리 영역으로 통신 제어 정보가 기록됨
    * 프로토콜 스택은 소켓의 제어 정보를 참조하면서 동작
    * 디스크립터로 식별
* 포트 번호 : 통신 상대의 소켓을 식별하기 위한 번호
* 헤더 : 패킷에서 통신 동작을 제어하는 제어 정보가 들어 있는 부분
* LAN 어댑터 : 네트워크 인터페이스 (네트워크용 하드웨어), 패킷을 전기 신호로 변환하여 네트워크 케이블에 송출
    * 버퍼 메모리, MAC, PHY(MAU) (신호 송수신 회로), RJ-45 커넥터로 구성
    * MAC 회로에서 송신 패킷에 프리앰블, 스타트 프레임 딜리미터, 프레임 체크 시퀀스 부가
* LAN 드라이버 : LAN 어댑터를 제어하는 소프트웨어
* MAC 주소 : 이더넷용 주소, 패킷 중계에 이용
* 이더넷 : IP가 경로를 설정하면 이더넷이 라우터에서 라우터로 운반함
* ARP : Address Resolution Protocol, IP 주소에 대응하는 이더넷의 MAC 주소를 조사할 때 사용하는 프로토콜
* ICMP : Internet Control Message Protocol, 패킷을 운반할 때 발생하는 오류를 통지하거나 제어용 메시지를 통지할 때 사용하는 프로토콜


### LAN
* LAN : 근거리 통신망, 가까운 지역을 한데 묶는 네트워크
* 트위스트 페어 케이블 : LAN 케이블로 사용, 외부 잡음을 상쇄하기 위해 꼬여 있음
* 크로스토크 : 같은 케이블 안의 신호선에 의한 전자파가 누설되어 잡음이 발생하는데 이러한 잡음에 의한 영향
    * 트위스트 페어 케이블의 꼬는 간격을 변화시켜 크로스토크를 방지
* 리피터 허브 : 연결된 케이블 전체에 신호를 송신하는 허브
    * 네트워크 전체에 신호를 뿌리고 수신처 MAC 주소에 해당하는 기기만 패킷을 수신하는 이더넷의 기본 원리를 그대로 실현한 기기
    * 신호 변환 없이 그대로 신호를 흘림
* MDI : 신호 송수신 회로와 RJ-45 커넥터를 직접 결선하는 방식
* MDI-X : 신호 송수신 회로와 RJ-45 커넥터를 교차 결선하는 방식
* 스위칭 허브 : MAC 주소표에서 수신처 MAC 주소를 조사하고 해당 포트에서 신호를 송신하는 허브
    * 허브는 이더넷을 바탕으로 동작
    * 송신처 MAC 주소를 알아내야 하므로 디지털 데이터로 변환하고 FCS도 검사하지만 모든 패킷을 수신하므로 포트의 MAC 회로에 MAC 주소가 할당되어 있지 않음
    * 전이중 모드로 동작 가능
* 전이중 모드 : 송수신을 동시에 실행하는 모드
    * 수신이 끝나기를 기다릴 필요 없고 송수신 동시에 가능하므로 반이중 모드보다 데이터 전송이 빠름
* 반이중 모드 : 수신 신호선에 신호가 흐르지 않는 것을 확인하고 송신하는 모드
* 충돌 : 둘 이상의 신호가 뒤섞이는 상태
    * 재밍 신호 : 이더넷에서 충돌이 발생한 경우 이를 알리기 위해 흘리는 특수 신호
* 자동 조정 : 링크 펄스를 통해 지원 가능 모드와 전송 속도를 통신 상대에 통지하고 최적의 조합으로 자동 전환하는 것
* 라우터 : IP를 바탕으로 동작하는 패킷 중계 장치
    * 경로표(라우팅 테이블)를 이용하여 송신 포트와 중계 대상을 판별
    * 라우터의 각 포트에는 MAC 주소와 IP 주소가 할당되어 있음
* 경로표 : 라우터가 중계 대상 판별에 이용하는 표
    * 수신처, 넷마스크, 게이트웨이, 인터페이스 항목, 메트릭으로 구성
    * 스위칭 허브와 달리 경로 정보를 등록하거나 갱신하는 동작은 패킷 중계 동작과 분리되어 있음
        * 사람이 수동으로 등록/갱신
        * 라우팅 프로토콜을 사용하여 라우터들끼리 경로 정보를 교환하고 라우터가 자체적으로 자동 등록/갱신
    * 경로표에 수신처에 해당하는 행이 없는 경우 ICMP 메시지로 송신처에 오류 통지 후 패킷 폐기 
        * 허브와 동작 방식이 다름
        * 라우터가 가정하는 네트워크 크기가 허브보다 훨씬 크므로 브로드캐스팅으로 인한 네트워크 혼잡을 방지하기 위함
* 경로표에서의 넷마스크 : 경로표의 수신처 IP 주소와 패킷의 수신처 IP 주소를 대조할 때 비교 대상 비트 수를 나타냄
* 기본 게이트웨이 : 경로표에 해당하는 행(경로)이 없는 경우 선택하는 중계 대상, 기본 경로의 게이트웨이
* 조각 나누기 : 중계 패킷 MTU가 출력 포트측 MTU를 초과하는 경우 IP 프로토콜에 규정된 조각 나누기를 사용하여 패킷을 분할
    * IP 헤더의 플래그 필드를 조사하여 분할 가능한지 확인
* 라우터와 스위칭 허브의 관계
    * 라우터는 IP의 개념에 기초
    * 스위칭 허브는 이더넷에 기초
    * 통신 상대까지 패킷을 전달하는 전체 과정(+경로 설정)은 IP(라우터)가 담당하고, IP(라우터)는 이더넷(스위칭 허브)에 라우터 간 패킷 운반을 의뢰
    * IP는 적절한 통신 기술에 패킷 운반을 의뢰함 (이더넷, 무선 LAN, ADSL, FTTH 등)
* 주소 변환 : 프라이비트 주소를 할당한 사내 네트워크와 인터넷 사이에서 주소 변환이 이루어져야 같은 주소 간 충돌이 발생하지 않음
    * 인터넷측은 대응표에 등록되어 있는 프라이비트 주소와 포트 번호에 해당하는 기기와 어플리케이션에만 접근 가능하므로 부정 침입을 방지하는 효과가 있음
* 글로벌 주소 : 인터넷 고유의 주소
* 프라이비트 주소 : 주소 부족에 대처하기 위한 사내용 주소
* 패킷 필터링 : 패킷 헤더를 조사하여 사전에 설정한 조건에 따라 패킷을 중계하거나 폐기하는 라우터의 부가 기능
    * 부정 침입을 방지

### 액세스 회선
* 액세스 회선 : 인터넷과 가정이나 회사의 LAN을 연결하는 통신 회선, 통신 사업자와 사용자를 연결하는 통신 회선
* ADSL : Asymmetric Digital Subscriber Line, 전주에 부설된 전화용 금속제 케이블을 이용하여 고속으로 통신하는 액세스 회선, 업로드/다운로드의 통신 속도가 서로 다름
* ADSL 모뎀 : 패킷을 ATM 셀로 분할하고, 전기 신호로 바꾸어 스플리터에 송신하는 기기
* 직교 진폭 변조 : 진폭 변조 방식과 위상 변조 방식을 결합하여 한 개의 파에 대응시키는 비트 수를 늘려 속도를 높인 변조 방식
    * ADSL은 직교 진폭 변조를 이용하고 여러 주파수의 파를 합성하여 고속화를 꾀함 
* 스플리터 : 전화 회선에서 사용자 측으로 신호가 흘러들어올 때 전화(낮은 주파수)와 ADSL의 신호(높은 주파수)를 나누어 전화기측에 ADSL의 신호가 흐르지 않게 함
    * 스플리터는 전화기측의 통신 여부가 ADSL 회선에 영향을 주는 것도 방지함
* DSLAM : DSL Access Multiplexer (전화국용 ADSL 집합 모뎀), 다수의 ADSL 모뎀을 하나의 케이스에 넣은 기기
    * ATM 인터페이스를 가지고 있고 패킷을 셀 형태 그대로 BAS에 넘김
* FTTH : 광섬유를 이용한 액세스 회선
    * 코어의 직경에 따라 싱글모드(가는 것), 멀티모드(굵은 것)로 분류
        * 싱글모드 : 광원과 수광 소자의 성능이 높아야 하지만 신호의 변형이 적으므로 케이블 길이를 길게 할 수 있음, 따라서 멀리 떨어진 건물 사이를 연결할 때 사용
        * 멀티모드 : 복수의 빛이 흐르므로 광원이나 수광 소자의 성능이 비교적 낮아도 상관없지만 광섬유가 길어짐에 따라 신호의 변형이 커지므로 한 건물 안을 연결하는 용도로 사용
* BAS : Broadband Access Server (광대역 액세스 서버), 라우터의 일종, PPP 프로토콜을 이용하여 인증 서버에 본인 확인을 하고 설정 정보를 사용자측(보통 인터넷 접속용 라우터)에 통지함, 라우터의 일종이므로 패킷 중계도 함
    * 통지하는 설정 정보에는 인터넷에 접속하는 기기에 할당할 글로벌 주소, DNS 서버의 IP 주소, 기본 게이트웨이의 IP 주소가 있음
* PPP : Point-to-Point Protocol, 본인 확인, 설정값 통지 등을 위해 사용하는 프로토콜
    * 이더넷과 함께 사용하는 경우 패킷에 PPPoE(PPP over Ethernet) 헤더가 부가됨
* 터널링 : 데이터 패킷을 네트워크 상에서 가상의 파이프를 통해 전달하는 기술
    * 패킷을 별도의 패킷 내에 캡슐화하여 목적지까지 전송
* POP : Point of Presence, 인터넷 액세스 포인트의 위치
* NOC : Network Operation Center, 프로바이더의 핵심이 되는 설비
* IX : Internet eXchange, 프로바이더들을 접속하는 중심 설비
    * 고속 LAN 인터페이스를 다수 장착한 레이어 2 스위치(고성능의 거대한 스위칭 허브)가 중심이 되어 프로바이더의 라우터들을 연결
* 라우팅 프로토콜 : 라우터 간 경로 정보를 교환하는데 사용하는 프로토콜, 이를 통해 경로 정보를 라우터가 자동으로 등록하고 갱신함

### 방화벽과 캐시 서버
* 방화벽 : 네트워크를 외부 공격으로부터 지키기 위해 고안된 최초의 구조
* 패킷 필터링 : 방화벽 유형 중 하나로, 패킷의 헤더에 들어 있는 통신 제어 정보에 대한 조건을 설정하여 특정 패킷만 통과시킴
    * 송신처/수신처 IP 주소로 통신의 시점과 종점에 대한 조건을 설정
    * 포트 번호로 액세스 가능 서버 애플리케이션 종류 설정
    * 컨트롤 비트로 접속 방향에 대한 조건 설정
    * 패킷 필터링형 방화벽은 주소 변환 기능도 가지고 있으므로 인터넷측에서 사내 LAN에 대한 액세스를 금지하는 조건은 설정할 필요 없음
* 데이터센터 : 프로바이더의 중심 부분에 있는 NOC나 프로바이더들이 상호 접속하는 IX에 직접 접속된 시설
    * 인터넷의 중심부에 고속 회선으로 접속되어 있으므로 이곳에 서버를 설치하면 고속 액세스 가능
    * 안전성도 높음
* 분산 처리 : 복수의 서버에 처리를 분담하여 서버 한 대당 처리량을 줄이는 방법
* 라운드 로빈 : DNS 서버에 같은 도메인명으로 여러 대의 웹 서버를 등록하여 조회 시마다 차례대로 돌아가며 회답함으로써 복수 서버에 균등하게 액세스를 분산시키는 방법
    * 복수 페이지에 걸쳐 클라이언트와 서버가 대화하는 경우 액세스하는 서버가 변하면 대화가 도중에 끊길 수 있음
* 부하 분산 장치(로드 밸런서) : DNS 서버에 웹 서버 대신 등록하여 복수의 웹 서버에 리퀘스트 메시지를 분배함
    * 웹 서버의 부하 상태, 대화가 복수 페이지에 걸쳐 있는지(여러 리퀘스트가 일련의 동작인지) 여부를 고려하여 분배
    * 대화가 복수 페이지에 걸쳐 있는지 여부는 양식 데이터에 정보를 부가하거나 쿠키를 이용하여 판별
* 캐시 서버 : 프록시 구조를 사용하여 데이터를 캐시에 저장하는 서버
    * 웹 서버 대신 DNS 서버에 등록됨
    * 액세스 동작을 중개할 때 웹 서버에서 받은 데이터를 디스크에 저장해 두고 추후 요청시 웹 서버 대신 데이터를 클라이언트에 반송
* 프록시 : 클라이언트와 웹 서버 사이에서 액세스 동작을 중개하는 구조
* 콘텐츠 전송 네트워크 : Content Delivery Network, 인터넷 곳곳(POP)에 캐시 서버를 설치하여 지리적 제약 없이 전 세계 사용자에게 빠르게 콘텐츠를 제공하는 기술
    * DNS 서버를 세밀하게 설정하거나 리다이렉트 서버를 이용하여 클라이언트로부터 가장 가까운 캐시 서버에 액세스하도록 함
    * 성능을 높이기 위해 웹 서버에서 데이터 갱신하는 경우 즉시 캐시 서버에 반영함
        * 캐시 서버의 데이터는 항상 최신의 상태를 유지하므로 데이터 갱신을 확인할 필요가 없어지고, 최초로 액세스한 경우에도 캐시 데이터를 이용할 수 있음 

### 웹 서버
* 서버의 LAN 어댑터, 프로토콜 스택, Socket 라이브러리 등은 클라이언트와 같지만, 서버 어플리케이션과 클라이언트 어플리케이션은 호출하는 Socket 라이브러리 부품과 어플리케이션 구조가 다름
    * 서버 애플리케이션은 다수의 클라이언트와 1대1로 대화해야 하는데 이때 OS의 멀티스레드 기능을 사용함
* 데이터 송수신 동작은 클라이언트와 서버 간 차이가 없음
* 클라이언트와 서버 간 차이는 접속 동작에 있음
    * 접속하는 측이 클라이언트, 접속을 기다리는 측이 서버
* 서버 애플리케이션 동작 순서
    * 소켓 작성(socket 호출) -> 소켓에 포트 번호 기록(bind 호출) -> 소켓을 접속 대기 상태로 만듦(listen 호출) -> 접속 접수(accept 호출) -> 클라이언트와 대화하는 스레드에 소켓을 넘김 -> accept로 돌아감
    * 클라이언트와 대화하는 부분은 데이터 수신(read 호출) -> 리퀘스트 메시지 처리(애플리케이션 내부 로직 호출) -> 데이터 송신(write 호출) -> 연결 끊기(close 호출) -> 종료
    * accept 호출시 서버는 접속 패킷의 도착을 기다리다가 도착시 접속 접수 동작 실행 (바로 접수하는 것이 아님)
    * 위 흐름은 각각 다른 스레드로 실행됨
    * 접속 접수 동작에서 접속 대기 상태인 소켓을 복사하여 새 소켓을 만들고 이를 클라이언트측의 소켓과 접속한 후 대화하는 부분에 넘김
        * 이때 소켓에 기록된 포트 번호는 모두 같으므로 클라이언트로부터 패킷이 도착했을 때 대화중인 소켓을 식별하기 위해서는 클라이언트/서버측 IP 주소/포트 번호가 모두 필요 
* 응답 메시지
* 가상 디렉토리 : 클라이언트가 정적 데이터를 요청하면 웹 서버는 가상 디렉터리 경로를 실제 디렉터리 경로로 변환하여 해당 데이터를 반송
* WAS는 웹 서버와 웹 컨테이너로 구성
    * 서블릿 컨테이너는 웹 컨테이너의 일종
* 액세스 제어 : 액세스 동작 여부에 대한 조건을 설정하는 기능
    * 주로 클라이언트 주소, 클라이언트 도메인명, 사용자명과 패스워드 조건을 사용
* 응답 데이터 형식은 Content-Type 헤더 필드의 값으로 나타내는 것이 원칙임
    * 요청 파일 확장자, 데이터 내용을 조사하여 데이터 형식 판단 근거로 활용 가능
    * Content-Type 필드를 사용하여 데이터의 종류를 나타내는 방법은 MIME(Multipurpose, Internet Mail Extensions) 사양에 규정되어 있음