# 컴퓨터 구조
## 핵심 주제
컴퓨터가 이해하는 정보 - 데이터와 명령어
컴퓨터의 네 가지 핵심 부품 - CPU, 메모리, 보조기억장치, 입출력장치

---

### 문자 인코딩
* 문자 집합 : 컴퓨터가 인식할 수 있는 문자의 모음으로 인코딩 대상
* 유니코드 : 여러 나라의 문자들을 광범위하게 표현할 수 있는 통일된 문자 집합
    * UTF-8으로 다시 인코딩


## 명령어
* 명령어는 연산 코드(연산자)와 오퍼랜드(피연산자)로 구성
* 오퍼랜드 : 연산에 사용할 데이터 또는 연산에 사용할 데이터가 저장된 위치(메모리 주소나 레지스터 이름)
    * 오퍼랜드 필드를 주소 필드라고 부르기도 함
    * 오퍼랜드가 n개인 명령어 -> n-주소 명령어
* 연산 코드 : 명령어가 수행할 연산
    * 대표적인 연산 코드 유형
        1. 데이터 전송
        2. 산술/논리 연산
        3. 제어 흐름 변경
        4. 입출력 제어


### 주소 지정 방식
* 유효 주소 : 연산의 대상이 되는 데이터가 저장된 위치
* 주소 지정 방식 : 연산에 사용할 데이터 위치를 찾는 방법
* 각 주소 지정 방식이 오퍼랜드 필드에 명시하는 값
    1. 즉시 주소 지정 방식 : 연산에 사용할 데이터
        * 메모리 접근 없음
    2. 직접 주소 지정 방식 : 유효 주소(메모리 주소)
        * 메모리 접근 1회
    3. 간접 주소 지정 방식 : 유효 주소의 주소
        * 메모리 접근 2회
    4. 레지스터 주소 지정 방식 : 유효 주소(레지스터 이름)
        * 메모리 접근 없음
    5. 레지스터 간접 주소 지정 방식 : 유효 주소를 저장한 레지스터
        * 메모리 접근 1회


## CPU
* 메모리에 저장된 명령어를 읽어 들이고, 해석하고, 실행하는 장치
* 계산을 담당하는 ALU, 명령어를 읽어 들이고 해석하는 제어장치, 작은 임시 저장 장치인 레지스터로 구성


### ALU
* 레지스터로부터 피연산자를 받아들이고, 제어장치로부터 수행할 연산을 알려 주는 제어 신호를 받아들임
* 연산 수행 후 결괏값은 레지스터에 일시적으로 저장
* 연산 결과에 대한 추가적인 정보를 플래그 레지스터에 저장


### 제어장치
* 제어 신호를 내보내고 명령어를 해석하는 부품
* 제어 신호 : 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호
* 제어 장치가 받아들이는 정보
    1. 클럭 신호
        * 클럭 : 컴퓨터의 시간 단위
    2. 해석해야 할 명령어
        * 명령어 레지스터로부터 명령어를 받아들임
    3. 플래그 레지스터 속 플래그 값
        * 플래그는 ALU 연산에 대한 추가적인 상태 정보
        * 제어장치는 플래그 값을 참고하여 제어 신호를 발생시킴
    4. 제어 버스로 전달된 제어 신호
        * CPU 외부 장치도 제어 신호를 발생시킴
* 제어장치가 내보내는 정보 : CPU 내/외부에 전달하는 제어 신호


### 레지스터
1. 프로그램 카운터 : a.k.a. 명령어 포인터, 메모리에서 읽어 들일 명령어의 주소를 저장
2. 명령어 레지스터 : 메모리에서 읽어 들인, 해석할 명령어를 저장
3. 메모리 주소 레지스터 : 메모리의 주소를 저장
    * CPU가 읽어들이고자 하는 주소 값을 주소 버스로 보낼 때 메모리 주소 레지스터를 거침
4. 메모리 버퍼 레지스터 : a.k.a. 메모리 데이터 레지스터, 메모리와 주고받을 값(데이터롸 명령어)을 저장
    * 데이터 버스로 주고받을 값은 메모리 버퍼 레지스터를 거침
5. 플래그 레지스터 : 연산 결과 또는 CPU 상태에 대한 부가적인 정보 저장
6. 범용 레지스터 : 다양하고 일반적인 상황에서 자유롭게 사용 가능
7. 스택 포인터 : 메모리 스택 영역에 있는 스택의 꼭대기 주소 저장
    * 스택 주소 지정 방식 : 스택과 스택 포인터를 이용한 주소 지정 방식
8. 베이스 레지스터 : 베이스 레지스터 주소 지정 방식에 이용됨
    * 변위 주소 지정 방식
        * 오퍼랜드 필드의 값(변위)과 특정 레지스터의 값을 더하여 유효 주소를 얻어내는 주소 지정 방식
        * 상대 주소 지정 방식 : 오퍼랜드와 프로그램 카운터의 값을 더하여 유효 주소를 얻는 방식
        * 베이스 레지스터 주소 지정 방식 : 오퍼랜드(변위)와 베이스 레지스터의 값(기준 주소)을 더하여 유효 주소를 얻는 방식


### 명령어 사이클과 인터럽트
* 명령어 사이클 : CPU가 하나의 명령어를 처리하는 주기로, 인출, 실행, 간접, 인터럽터 사이클로 구성
    * 인출 사이클 : 명령어를 메모리에서 CPU로 가져오는 단계
    * 실행 사이클 : CPU로 가져온 명령어를 실행하는 단계로, 제어장치가 명령어 레지스터에 담긴 값을 해석하고 제어 신호를 발생시킴
    * 간접 사이클 : 명령어를 실행하기 위해 메모리 접근이 더 필요한 경우 이를 수행하는 단계
    * 인터럽트 사이클 : 아래 내용 참고


* 인터럽트 : CPU의 정상적인 작업을 방해하는 신호
    * 동기 인터럽트와 비동기 인터럽트로 구분
    * 동기 인터럽트(예외) : CPU가 명령어 처리 중 예외적인 상황에 마주쳤을 때 발생하는 인터럽트
    * 비동기 인터럽트(하드웨어 인터럽트) : 입출력장치에 의해 발생하는 인터럽트로 알림과 같음
        * CPU가 입출력 작업 도중에도 효율적으로 명령어를 처리할 수 있게 해줌


* 하드웨어 인터럽트 처리 순서
    1. 입출력장치가 CPU에 인터럽트 요청 신호를 보냄
    2. CPU가 실행 사이클과 인출 사이클 사이에 항상 인터럽트 여부를 확인
    3. CPU가 인터럽트 요청을 확인하고 인터럽트를 받아들일 수 있는지 확인
    4. 인터럽트를 받아들일 수 있다면 CPU가 수행하던 작업을 백업
    5. CPU가 인터럽트 벡터를 참조하여 인터럽트 서비스 루틴 실행
    6. 인터럽트 서비스 루틴 실행이 끝나면 4에서 백업해둔 작업을 복구하여 실행 재개


* 하드웨어 인터럽트 관련 용어
    * 인터럽트 플래그 : 인터럽트 요청 신호를 받아들일지 무시할지 결정하는 비트
    * 인터럽트 서비스 루틴 : a.k.a. 인터럽트 핸들러, 인터럽트를 처리하는 프로그램
    * 인터럽트 벡터 : 인터럽트 서비스 루틴의 시작 주소를 포함하는 인터럽트 서비스 루틴의 식별 정보

    
* 예외의 종류
    * 폴트 : 예외 처리 직후 예외가 발생한 명령어부터 실행을 재개하는 예외
    * 트랩 : 예외 처리 직후 예외가 발생한 명령어의 다음 명령어부터 실행을 재개하는 예외
    * 중단 : CPU가 실행 중인 프로그램을 강제로 중단시킬 수밖에 없는 심각한 오류를 발견했을 때 발생하는 예외
    * 소프트웨어 인터럽트 : 시스템 호출이 발생했을 때 나타나는 예외
    
